/*
 * شبیه‌ساز موج دیجیتال در ترمینال
 *
 * توضیح:
 *  یک آرایه‌ی موج به طول ثابت تعریف می‌کنیم که در هر خانه، ارتفاع موج (عددی بین 0 تا MAX_HEIGHT)
 *  را نگه می‌دارد. یک متغیر head_height داریم که «سر موج» را نشان می‌دهد و در هر فریم بالا یا پایین می‌رود.
 *  سپس مقادیر آرایه را یک خانه به راست شیفت می‌دهیم و head_height جدید را در موج[0] قرار می‌دهیم.
 *  در نهایت آرایه را به‌صورت ستونی در ترمینال رسم می‌کنیم: برای هر ستون (اندیس آرایه) یک ستاره (*)
 *  در ردیف مربوط به ارتفاع آن ستون چاپ می‌شود و بقیه ردیف‌ها فاصله می‌خورند.
 *
 * نکات پیاده‌سازی:
 *  - WIDTH: تعداد ستون‌های موج (عرض «باند» موج).
 *  - MAX_HEIGHT: حداکثر ارتفاع موج (هر ارتفاع را از 0 تا MAX_HEIGHT در نظر می‌گیریم).
 *  - head_height: مقدار ارتفاع در «سر» موج که در هر فریم بالا یا پایین می‌رود.
 *  - head_dir: جهت تغییر head_height (۱ یعنی بالا، -۱ یعنی پایین).
 *  - در حلقه‌ی اصلی:
 *     1. head_height را بر اساس head_dir به‌روزرسانی می‌کنیم (اگر به انتها رسید جهت را معکوس می‌کنیم).
 *     2. آرایه‌ی wave را یک خانه به راست شیفت می‌دهیم و head_height جدید را در موج[0] می‌گذاریم.
 *     3. با استفاده از ANSI escape code صفحه را پاک می‌کنیم.
 *     4. موج را به‌صورت ستونی رسم می‌کنیم: از سطر MAX_HEIGHT تا 0 برای هر ستون چاپ می‌کنیم.
 *     5. تأخیری (sleep) برای مشاهده‌ی حرکت موج ایجاد می‌کنیم.
 *
 * برای اجرای این کد در اکثر ترمینال‌ها کافی است کامپایل کنید و برنامه را اجرا نمایید.
 * اگر در سیستم‌عاملی که ANSI escape code را پشتیبانی نمی‌کند کار می‌کنید، باید روش پاک کردن صفحه را متناسب تغییر دهید.
 */

#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>   // برای sleep() یا usleep()

#define WIDTH 20       // تعداد ستون‌های موج
#define MAX_HEIGHT 5   // حداکثر ارتفاع موج (از 0 تا MAX_HEIGHT)

int main() {
    int wave[WIDTH];
    int i, row;

    // مقداردهی اولیه موج: همه‌ی ستون‌ها را 0 قرار می‌دهیم
    for (i = 0; i < WIDTH; i++) {
        wave[i] = 0;
    }

    int head_height = 0;  // ارتفاع ابتدایی سر موج
    int head_dir = 1;     // جهت حرکت سر موج (1: بالا، -1: پایین)

    while (1) {
        // ---------- 1. به‌روزرسانی سر موج ----------
        if (head_height >= MAX_HEIGHT) {
            head_dir = -1;
        } else if (head_height <= 0) {
            head_dir = 1;
        }
        head_height += head_dir;

        // ---------- 2. شیفت آرایه و قرار دادن head_height در موج[0] ----------
        for (i = WIDTH - 1; i > 0; i--) {
            wave[i] = wave[i - 1];
        }
        wave[0] = head_height;

        // ---------- 3. پاک کردن صفحه (ANSI escape code) ----------
        // \e[H جا‌به‌جایی به گوشه‌ی بالا-چپ، \e[J پاک کردن از مکان جاری تا پایان صفحه
        printf("\e[H\e[J");

        // ---------- 4. رسم موج ستونی ----------
        // از MAX_HEIGHT به سمت 0 می‌آیم تا ردیف بالایی اولین چاپ شود
        for (row = MAX_HEIGHT; row >= 0; row--) {
            for (i = 0; i < WIDTH; i++) {
                if (wave[i] == row) {
                    // اگر ارتفاع ستون برابر سطر فعلی بود، ستاره چاپ کن
                    printf("*");
                } else {
                    // در غیر این صورت فاصله خالی
                    printf(" ");
                }
            }
            printf("\n");
        }

        // ---------- 5. تأخیر برای مشاهدهٔ حرکت موج ----------
        // می‌توانید عدد داخل usleep را کم یا زیاد کنید تا سرعت موج تغییر کند.
        usleep(200000);  // 200000 میکروثانیه = 0.2 ثانیه
    }

    return 0;
}

